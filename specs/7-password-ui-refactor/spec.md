# Feature Specification: Persistent Password UI

## Description
优化领取和归还资产时的临时密码显示逻辑。取消现有的弹窗提示方式，改为在主界面的标题与“使用中”模块之间直接显示当前生成的密码。密码需根据操作类型（领取或归还）显示特定格式，并具备2小时的自动消失机制，以提高用户体验并减少不必要的交互。

## Clarifications
### Session 2026-02-24
- Q: 如果用户在2小时内进行了多次操作，界面如何处理？ → A: **仅显示最后一次**。新生成或获取的密码将直接覆盖之前显示的密码，并重新开始2小时倒计时。
- Q: 当没有有效密码（如刚登录或密码已过期）时，显示区域的状态？ → A: **完全隐藏**。不显示任何占位符或空白区域。
- Q: 密码显示区域的视觉样式有何要求？ → A: **使用绿色边框包裹**。使密码信息在页面中清晰可辨。
- Q: 用户是否可以手动关闭正在显示的密码？ → A: **不可以**。密码仅在2小时后自动消失或被新操作覆盖。
- Q: 密码过期时，绿色边框是否保留？ → A: **不保留**。边框与文字必须同时完全移除，确保页面简洁。
- Q: 是否需要显示过期倒计时？ → A: **不需要**。仅显示密码文字，保持界面简洁，避免干扰。

## User Scenarios

### Scenario 1: Uninterrupted Password Access
**Actor**: Employee (User)
1. 用户完成资产领取操作。
2. 系统不再弹出包含密码的对话框，而是直接在页面顶部标题下方显示“领取密码：1234”。
3. 用户可以直接看着页面去开启物理锁，无需点击关闭弹窗或担心误触关闭。

### Scenario 2: Return Password Display
**Actor**: Employee (User)
1. 用户完成资产归还操作。
2. 页面在指定位置显示“归还密码：5678”。
3. 用户使用该密码完成归还流程。

### Scenario 3: Password Expiration
**Actor**: Employee (User)
1. 用户领取资产后，界面显示了领取密码。
2. 2小时后，即使用户没有刷新页面，该密码显示区域也会自动消失，恢复到初始状态。
3. 如果用户在2小时内刷新了页面，系统根据记录的生成时间判断，若未满2小时，则继续显示该密码。

## Functional Requirements

### 1. UI Refactor
- **1.1 Remove Popups**: 禁用/移除领取和归还成功后的密码弹窗逻辑。
- **1.2 Embedded Display**: 在页面标题（Title）与“使用中”（In Use/Active Assets）模块之间新增一个明显的密码显示区域。**当无有效密码时，该区域必须完全隐藏（不占据布局空间）**。
- **1.3 Visual Styling**: 密码显示区域需使用**绿色边框**包裹，确保视觉上的显著性和区分度。
- **1.4 Dynamic Formatting**: 
  - 领取操作后显示：“领取密码：xxxx”
  - 归还操作后显示：“归还密码：xxxx”

### 2. Persistence & Expiration
- **2.1 2-Hour Window**: 密码显示必须在生成后的120分钟内持续有效。
- **2.2 Auto-Hide**: 2小时有效期过后，该显示区域应自动从UI中移除/隐藏，无需用户干预。**系统不提供手动关闭或清除密码显示的按钮**。
- **2.3 Persistence Across Refresh**: 用户刷新浏览器或重新进入应用时，只要密码仍在2小时有效期内，必须重新渲染并显示。

### 3. Logic & State Management
- **3.1 Timestamp Tracking**: 系统需记录每个密码生成的精确时间。
- **3.2 State Update (Latest Only)**: 当新操作发生时，更新显示的密码内容及对应的过期时间戳。界面仅维持并显示一个最晚生成的有效密码；新的操作将重置并覆盖当前的密码显示。

## Success Criteria
1. **Seamless Workflow**: 用户在操作成功后，无需任何额外点击即可查看到开启物理锁所需的密码。
2. **Visual Consistency**: 密码显示区域在不同屏幕尺寸下均能正确位于标题和“使用中”模块之间，且样式醒目。
3. **Timer Accuracy**: 密码消失的时间误差应控制在1分钟以内。
4. **Resilience**: 页面刷新、网络切换或重新登录（在2小时内）均不应导致有效密码消失。

## Key Entities
- **ActivePassword**: 
  - `Code`: 密码字符串
  - `Type`: 领取 (Pickup) / 归还 (Return)
  - `CreatedAt`: 生成时间戳
  - `ExpiresAt`: 过期时间戳 (CreatedAt + 2 hours)

## Assumptions
- **A1**: 用户在同一时间内通常只需要关注最近一次生成的密码。
- **A2**: 前端具备定时器机制，能够每分钟或实时检测密码是否过期。
- **A3**: “标题”和“使用中”模块是主界面的固定组成部分。

## Constraints
- **C1**: 密码仅在当前用户 session 下可见。
- **C2**: 密码过期后必须彻底从前端状态中清除，不可通过简单隐藏 CSS 来绕过。
